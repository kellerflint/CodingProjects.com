<!-- Example of HTML formatting and JS code to do inline validation -->

<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS Validation Example</title>
</head>

<body>
<form action="fake.html">
    <div class="val-empty">
        <label for="name">Name</label>
        <input class="input" id="name">
        <div class="errors">
        </div>
    </div>

    <div class="val-phone val-empty">
        <label for="phone">Phone</label>
        <input class="input" id="phone">
        <div class="errors">
        </div>
    </div>
    <button type="submit">Submit</button>
</form>


<script src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<script>
    // classes to be validated
    let validations = [
        ["val-empty", isEmpty],
        ["val-phone", phoneValid]
    ];

    /* --- Validation functions --- */
    function isEmpty(input, valClass) {
        let isValid = false;
        if (input.val().trim() === "") {
            isValid = true;
        }
        toggleErrors(input, valClass, !isValid, "Cannot be empty.");
        return !isValid;
    }

    function phoneValid(input, valClass) {
        let isValid = false;
        console.log("ran");
        if (input.val().trim().length === 10) {
            isValid = true;
        }
        toggleErrors(input, valClass, isValid, "Must have 10 digits.");
        return isValid;
    }


    /* --- Helper functions --- */

    // sets all of the input and submit event listeners to validate the classes given in validations
    for (let i = 0; i < validations.length; i++) {
        // validation on input
        $("." + validations[i][0]).find(".input").on("input focus blur", function () {
            validations[i][1]($(this), validations[i][0]);
        });

        // validation on submit
        $("form").submit(function (event) {
            if (!validations[i][1]($("." + validations[i][0]).find(".input"), validations[i][0])) {
                event.preventDefault();
            }
        });
    }

    function toggleErrors(object, valClass, isValid, message) {
        if (!isValid) {
            if ($(object).parent().find(".errors").find("." + valClass + "-error").length == 0) {
                $(object).parent().find(".errors").append("<div class='error " + valClass + "-error'>" + message + "</div>");
            }
        } else {
            $(object).parent().find(".errors").find("." + valClass + "-error").remove();
        }
    }
</script>
</body>

</html>